import{s as F,z as O,e as R,i as v,d as _,f as y,a as A,g as C,h as T,c as E,j as k,D as U,x as d,R as B,M as I,N as Z,O as G,l as w,m as P,C as z,n as N}from"../chunks/scheduler.70959352.js";import{S as H,i as J,b as K,d as Q,m as W,a as X,t as $,e as x}from"../chunks/index.06bdbd9c.js";import{A as ee}from"../chunks/AuthCheck.0a0c7e55.js";import{u as te,i as se,b as S,d as D,p as le,t as ne}from"../chunks/firebase.0ebf22c9.js";import{u as ae}from"../chunks/auth.f758fd13.js";function ie(a){let e,s,n,t,l,i,b,g,m,f=a[1]&&L(a),u=!a[3]&&a[5]&&M(),c=a[3]&&!a[2]&&!a[1]&&V(a),r=a[2]&&Y(a);return{c(){e=y("form"),s=y("input"),n=A(),t=y("div"),f&&f.c(),l=A(),u&&u.c(),i=A(),c&&c.c(),b=A(),r&&r.c(),this.h()},l(o){e=C(o,"FORM",{class:!0});var p=T(e);s=C(p,"INPUT",{type:!0,placeholder:!0,class:!0}),n=E(p),t=C(p,"DIV",{class:!0});var h=T(t);f&&f.l(h),l=E(h),u&&u.l(h),i=E(h),c&&c.l(h),b=E(h),r&&r.l(h),h.forEach(_),p.forEach(_),this.h()},h(){k(s,"type","text"),k(s,"placeholder","Username"),k(s,"class","input w-full"),U(s,"input-error",!a[3]&&a[5]),U(s,"input-warning",a[4]),U(s,"input-success",a[2]&&a[3]&&!a[1]),k(t,"class","my-4 min-h-16 px-8 w-full"),k(e,"class","w-2/5")},m(o,p){v(o,e,p),d(e,s),B(s,a[0]),d(e,n),d(e,t),f&&f.m(t,null),d(t,l),u&&u.m(t,null),d(t,i),c&&c.m(t,null),d(t,b),r&&r.m(t,null),g||(m=[I(s,"input",a[10]),I(s,"input",a[8]),I(e,"submit",Z(a[9]))],g=!0)},p(o,p){p&1&&s.value!==o[0]&&B(s,o[0]),p&40&&U(s,"input-error",!o[3]&&o[5]),p&16&&U(s,"input-warning",o[4]),p&14&&U(s,"input-success",o[2]&&o[3]&&!o[1]),o[1]?f?f.p(o,p):(f=L(o),f.c(),f.m(t,l)):f&&(f.d(1),f=null),!o[3]&&o[5]?u||(u=M(),u.c(),u.m(t,i)):u&&(u.d(1),u=null),o[3]&&!o[2]&&!o[1]?c?c.p(o,p):(c=V(o),c.c(),c.m(t,b)):c&&(c.d(1),c=null),o[2]?r?r.p(o,p):(r=Y(o),r.c(),r.m(t,null)):r&&(r.d(1),r=null)},d(o){o&&_(e),f&&f.d(),u&&u.d(),c&&c.d(),r&&r.d(),g=!1,G(m)}}}function oe(a){let e,s,n,t,l=a[6].username+"",i,b,g,m="(Usernames cannot be changed)",f,u,c="Upload Profile Image";return{c(){e=y("p"),s=w("Your username is "),n=y("span"),t=w("@"),i=w(l),b=A(),g=y("p"),g.textContent=m,f=A(),u=y("a"),u.textContent=c,this.h()},l(r){e=C(r,"P",{class:!0});var o=T(e);s=P(o,"Your username is "),n=C(o,"SPAN",{class:!0});var p=T(n);t=P(p,"@"),i=P(p,l),p.forEach(_),o.forEach(_),b=E(r),g=C(r,"P",{class:!0,"data-svelte-h":!0}),z(g)!=="svelte-9l80or"&&(g.textContent=m),f=E(r),u=C(r,"A",{class:!0,href:!0,"data-svelte-h":!0}),z(u)!=="svelte-vogdig"&&(u.textContent=c),this.h()},h(){k(n,"class","text-success font-bold"),k(e,"class","text-lg"),k(g,"class","text-sm"),k(u,"class","btn btn-primary"),k(u,"href","/login/photo")},m(r,o){v(r,e,o),d(e,s),d(e,n),d(n,t),d(n,i),v(r,b,o),v(r,g,o),v(r,f,o),v(r,u,o)},p(r,o){o&64&&l!==(l=r[6].username+"")&&N(i,l)},d(r){r&&(_(e),_(b),_(g),_(f),_(u))}}}function L(a){let e,s,n,t;return{c(){e=y("p"),s=w("Checking availability of @"),n=w(a[0]),t=w("..."),this.h()},l(l){e=C(l,"P",{class:!0});var i=T(e);s=P(i,"Checking availability of @"),n=P(i,a[0]),t=P(i,"..."),i.forEach(_),this.h()},h(){k(e,"class","text-secondary")},m(l,i){v(l,e,i),d(e,s),d(e,n),d(e,t)},p(l,i){i&1&&N(n,l[0])},d(l){l&&_(e)}}}function M(a){let e,s="must be 3-16 characters long, alphanumeric only";return{c(){e=y("p"),e.textContent=s,this.h()},l(n){e=C(n,"P",{class:!0,"data-svelte-h":!0}),z(e)!=="svelte-1cznyih"&&(e.textContent=s),this.h()},h(){k(e,"class","text-error text-sm")},m(n,t){v(n,e,t)},d(n){n&&_(e)}}}function V(a){let e,s,n,t;return{c(){e=y("p"),s=w("@"),n=w(a[0]),t=w(" is not available"),this.h()},l(l){e=C(l,"P",{class:!0});var i=T(e);s=P(i,"@"),n=P(i,a[0]),t=P(i," is not available"),i.forEach(_),this.h()},h(){k(e,"class","text-warning text-sm")},m(l,i){v(l,e,i),d(e,s),d(e,n),d(e,t)},p(l,i){i&1&&N(n,l[0])},d(l){l&&_(e)}}}function Y(a){let e,s,n;return{c(){e=y("button"),s=w("Confirm username @"),n=w(a[0]),this.h()},l(t){e=C(t,"BUTTON",{class:!0});var l=T(e);s=P(l,"Confirm username @"),n=P(l,a[0]),l.forEach(_),this.h()},h(){k(e,"class","btn btn-success")},m(t,l){v(t,e,l),d(e,s),d(e,n)},p(t,l){l&1&&N(n,t[0])},d(t){t&&_(e)}}}function re(a){let e;function s(l,i){var b;return(b=l[6])!=null&&b.username?oe:ie}let n=s(a),t=n(a);return{c(){t.c(),e=R()},l(l){t.l(l),e=R()},m(l,i){t.m(l,i),v(l,e,i)},p(l,i){n===(n=s(l))&&t?t.p(l,i):(t.d(1),t=n(l),t&&(t.c(),t.m(e.parentNode,e)))},d(l){l&&_(e),t.d(l)}}}function ue(a){let e,s;return e=new ee({props:{$$slots:{default:[re]},$$scope:{ctx:a}}}),{c(){K(e.$$.fragment)},l(n){Q(e.$$.fragment,n)},m(n,t){W(e,n,t),s=!0},p(n,[t]){const l={};t&8319&&(l.$$scope={dirty:t,ctx:n}),e.$set(l)},i(n){s||(X(e.$$.fragment,n),s=!0)},o(n){$(e.$$.fragment,n),s=!1},d(n){x(e,n)}}}const fe=/^(?=[a-zA-Z0-9._]{3,16}$)(?!.*[_.]{2})[^_.].*[^_.]$/;function ce(a,e,s){let n,t,l,i,b;O(a,te,h=>s(6,b=h));const g=ae(se);O(a,g,h=>s(12,i=h));let m="",f=!1,u=!1,c;async function r(){s(2,u=!1),clearTimeout(c),s(1,f=!0),c=setTimeout(async()=>{console.log("checking availability of ",m);const h=S(D,"usernames",m),j=await le(h).then(q=>q.exists());s(2,u=!j),s(1,f=!1)},500)}async function o(){console.log("confirming username",m);const h=ne(D);h.set(S(D,"usernames",m),{uid:i==null?void 0:i.uid}),h.set(S(D,"users",i.uid),{username:m,photoUrl:(i==null?void 0:i.photoURL)??null,published:!0,bio:"I am a walrus",links:[{title:"Test Link",url:"https://svelte.dev",icon:"custom"}]}),await h.commit(),s(0,m=""),s(2,u=!1)}function p(){m=this.value,s(0,m)}return a.$$.update=()=>{a.$$.dirty&1&&s(3,n=(m==null?void 0:m.length)>2&&m.length<16&&fe.test(m)),a.$$.dirty&1&&s(5,t=m.length>0),a.$$.dirty&14&&s(4,l=n&&!u&&!f)},[m,f,u,n,l,t,b,g,r,o,p]}class be extends H{constructor(e){super(),J(this,e,ce,ue,F,{})}}export{be as component};
